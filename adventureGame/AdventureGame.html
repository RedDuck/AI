<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>First Person Adventura</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #111;
      color: #fff;
      display: flex;
      height: 100vh;
      overflow: hidden;
    }
    #inventory, #menu {
      width: 20%;
      padding: 1rem;
      box-sizing: border-box;
      background-color: #222;
    }
    #inventory {
      border-right: 2px solid #333;
    }
    #menu {
      border-left: 2px solid #333;
    }
    #scene {
      flex-grow: 1;
      padding: 1rem;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      position: relative;
      overflow-y: auto;
    }
    .clickable {
      padding: 10px;
      margin: 10px;
      background-color: #444;
      border: 1px solid #666;
      cursor: pointer;
      transition: background 0.3s;
    }
    .clickable:hover {
      background-color: #555;
    }
    h2 {
      margin-top: 0;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      margin: 0.5rem 0;
    }
    button {
      background: none;
      border: none;
      color: white;
      font: inherit;
      cursor: pointer;
    }
    button:hover {
      text-decoration: underline;
    }
    #log {
      width: 100%;
      background-color: #222;
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #333;
      box-sizing: border-box;
    }
  </style>
</head>
<body onload="updateInventory(); updateScene();">
  <div id="inventory">
    <h2>Invent√°≈ô</h2>
    <ul id="inventory-list"></ul>
  </div>
  <div id="scene">
    <div id="log"></div>
  </div>
  <div id="menu">
    <h2>Menu</h2>
    <ul>
      <li><button onclick="saveGame()">üíæ Ulo≈æit</button></li>
      <li><button onclick="loadGame()">üìÇ Naƒç√≠st</button></li>
      <li><button onclick="endGame()">‚ùå Konec</button></li>
    </ul>
  </div>

  <script>
    let inventory = ['baterka', 'klic'];
    let activeItem = null;
    let currentScene = 'chodba';
    let panelFixed = false;
    let doorUnlocked = false;
    let pojistkaTaken = false;
    let logMessages = [];

    function updateScene() {
      const scene = document.getElementById('scene');
      scene.innerHTML = '<div id="log">' + logMessages.join('') + '</div>';

      if (currentScene === 'chodba') {
        scene.innerHTML += '<h1>Jsi v temn√© chodbƒõ vesm√≠rn√© lodi.</h1>';
        if (!inventory.includes('baterka')) {
          scene.innerHTML += '<p>Je p≈ô√≠li≈° tma, nic nevid√≠≈°.</p>';
        } else {
          if (!doorUnlocked) {
            scene.innerHTML += `<div class="clickable" onclick="inspect('door')">Prozkoumat dve≈ôe</div>`;
          } else {
            scene.innerHTML += `<div class="clickable" onclick="changeScene('mistnost')">Vej√≠t do m√≠stnosti</div>`;
          }
          scene.innerHTML += `<div class="clickable" onclick="changeScene('sklad')">J√≠t do skladu</div>`;
        }
      } else if (currentScene === 'sklad') {
        scene.innerHTML += '<h1>Jsi ve skladu. Je tu nepo≈ô√°dek.</h1>';
        if (!pojistkaTaken) {
          scene.innerHTML += `<div class="clickable" onclick="pickup('pojistka')">Naj√≠t pojistku</div>`;
        }
        scene.innerHTML += `<div class="clickable" onclick="changeScene('chodba')">Zpƒõt do chodby</div>`;
      } else if (currentScene === 'mistnost') {
        scene.innerHTML += '<h1>M√≠stnost s ovl√°dac√≠m panelem.</h1>';
        if (!panelFixed) {
          scene.innerHTML += `<div class="clickable" onclick="inspect('panel')">Prohl√©dnout ovl√°dac√≠ panel</div>`;
        } else {
          scene.innerHTML += `<p>Panel je opraven√Ω. Tajn√© dve≈ôe se otev≈ôely.</p>`;
        }
        scene.innerHTML += `<div class="clickable" onclick="changeScene('chodba')">Zpƒõt do chodby</div>`;
      }
    }

    function inspect(item) {
      if (item === 'door') {
        if (activeItem === 'klic') {
          doorUnlocked = true;
          addLog('<p>Dve≈ôe jsou odemƒçen√©.</p>');
          inventory = inventory.filter(i => i !== 'klic');
          activeItem = null;
          updateInventory();
          updateScene();
        } else {
          addLog('<p>Dve≈ôe jsou zamƒçen√©. Pot≈ôebuje≈° kl√≠ƒç.</p>');
        }
      } else if (item === 'panel') {
        if (activeItem === 'pojistka') {
          panelFixed = true;
          pojistkaTaken = true;
          inventory = inventory.filter(i => i !== 'pojistka');
          activeItem = null;
          updateInventory();
          addLog('<p>Vlo≈æil jsi pojistku. Panel se rozsv√≠til!</p>');
          updateScene();
        } else {
          addLog('<p>Panel nefunguje. Nƒõco mu chyb√≠.</p>');
        }
      }
    }

    function changeScene(sceneName) {
      currentScene = sceneName;
      updateScene();
    }

    function pickup(item) {
      inventory.push(item);
      if (item === 'pojistka') {
        pojistkaTaken = true;
      }
      updateInventory();
      addLog(`<p>Sebral jsi: ${item}</p>`);
      updateScene();
    }

    function selectItem(item) {
      activeItem = activeItem === item ? null : item;
      updateInventory();
    }

    function updateInventory() {
      const list = document.getElementById('inventory-list');
      list.innerHTML = '';
      if (inventory.length === 0) {
        list.innerHTML = '<li>(pr√°zdn√Ω)</li>';
      } else {
        inventory.forEach(item => {
          let icon = item === 'baterka' ? 'üî¶' : item === 'klic' ? 'üóùÔ∏è' : item === 'pojistka' ? 'üîå' : 'üì¶';
          let isActive = activeItem === item ? ' style="background-color: #666; font-weight: bold;"' : '';
          list.innerHTML += `<li><button onclick="selectItem('${item}')"${isActive}>${icon} ${item[0].toUpperCase() + item.slice(1)}</button></li>`;
        });
      }
    }

    function addLog(message) {
      logMessages.push(message);
      const log = document.getElementById('log');
      if (log) log.innerHTML = logMessages.join('');
    }

    function saveGame() {
      const saveData = {
        inventory,
        activeItem,
        currentScene,
        panelFixed,
        doorUnlocked,
        pojistkaTaken,
        logMessages
      };
      localStorage.setItem('adventuraSave', JSON.stringify(saveData));
      alert('Hra byla ulo≈æena!');
    }

    function loadGame() {
      const data = localStorage.getItem('adventuraSave');
      if (data) {
        const saveData = JSON.parse(data);
        inventory = saveData.inventory;
        activeItem = saveData.activeItem;
        currentScene = saveData.currentScene;
        panelFixed = saveData.panelFixed;
        doorUnlocked = saveData.doorUnlocked;
        pojistkaTaken = saveData.pojistkaTaken;
        logMessages = saveData.logMessages;
        updateInventory();
        updateScene();
        alert('Hra byla naƒçtena!');
      } else {
        alert('≈Ω√°dn√° ulo≈æen√° hra nebyla nalezena.');
      }
    }

    function endGame() {
      const confirmExit = confirm('Opravdu chce≈° ukonƒçit hru?');
      if (confirmExit) {
        alert('D√≠ky za hran√≠!');
        location.reload();
      }
    }
  </script>
</body>
</html>
